"0","server <- function(input, output, session) {"
"0","  "
"0","  # Define parameters"
"0","  nb_of_class <- length(HEC_timetables_dummies$Class)"
"0","  nb_of_timeslot <- 55L # 11 time slot per day, times 5 days a week"
"0","  "
"0","  # Set matrix corresponding to coefficients of constraints"
"0","  f.con <- HEC_timetables_dummies %>%"
"0","    # Removed column that are not needed in the constraints"
"0","    select(-Start, -End, -Class, -Prof, -Day, -BA, -MG) %>% t()"
"0","  "
"0","  # Set coefficients of the objective function (min total credits taken)"
"0","  f.obj  <- HEC_timetables_dummies$Credit"
"0","    "
"0","  # Credit requirement"
"0","  credits <- reactive(input$credits)"
"0","  BA_credits <- reactive(input$BA_credits)"
"0","  MG_credits <- reactive(input$MG_credits)"
"0","  "
"0","  # Period of the day"
"0","  monday_morning <- reactive(input$monday_morning)"
"0","  monday_afternoon <- reactive(input$monday_afternoon)"
"0","  tuesday_morning <- reactive(input$tuesday_morning)"
"0","  tuesday_afternoon <- reactive(input$tuesday_afternoon)"
"0","  wednesday_morning <- reactive(input$wednesday_morning)"
"0","  wednesday_afternoon <- reactive(input$wednesday_afternoon)"
"0","  thursday_morning <- reactive(input$thursday_morning)"
"0","  thursday_afternoon <- reactive(input$thursday_afternoon)"
"0","  friday_morning <- reactive(input$friday_morning)"
"0","  friday_afternoon <- reactive(input$friday_afternoon)"
"0",""
"0","  output$timetable <- renderTable({"
"0","    "
"0","    # Set unequality/equality signs"
"0","    f.dir <- c("
"0","      ### USER CHOICES"
"0","      #### CREDITS -> Should be greater than threshold given by user"
"0","      "">="", # Credits constraint"
"0","      "">="", # BA Credits constraint"
"0","      "">="", # MG Credits constraint"
"0","      "
"0","      #### CLASS -> By default possible, put == (double) instead if WANT the class"
"0","      ""<="", # ""Advanced issues in International and European Tax Law"""
"0","      ""<="", # ""Algorithms for Business Intelligence and Digital Marketing"""
"0","      ""<="", # ""Animal Communication and Parasitism"""
"0","      ""<="", # ""Behavioral Economics"""
"0","      ""<="", # ""Business and Human Rights"""
"0","      ""<="", # ""Business and Society - Corporate Sustainability"""
"0","      ""<="", # ""Business Case en Marketing"""
"0","      ""<="", # ""Datascience for Marketing"""
"0","      ""<="", # ""Digitalisation of Purchasing and B to B Sales"""
"0","      ""<="", # ""Entrepreneurship and Strategy"""
"0","      ""<="", # ""Entrepreneurship, Innovation and Control Systems"""
"0","      ""<="", # ""Experimental Methods"""
"0","      ""<="", # ""Fraud and Business Process Analytics"""
"0","      ""<="", # ""Global Marketing"""
"0","      ""<="", # ""Heuristic Decision Making Strategies"""
"0","      ""<="", # ""Human Behavior and Evolutionary Inference"""
"0","      ""<="", # ""Individual Behavior in the Digital Environment"""
"0","      ""<="", # ""Integrated Marketing Communication (MScM)"""
"0","      ""<="", # ""La recherche dans tous ses états"""
"0","      ""<="", # ""Leadership Development"""
"0","      ""<="", # ""Luxury Marketing"""
"0","      ""<="", # ""Major Transition in Evolution"""
"0","      ""<="", # ""Managerial Decision Making"""
"0","      ""<="", # ""Normes comptables internationales (IFRS)"""
"0","      ""<="", # ""Production Control"""
"0","      ""<="", # ""Programming Tools in Data Science"""
"0","      ""<="", # ""Project in Data Analytics"""
"0","      ""<="", # ""Risk Analytics"""
"0","      ""<="", # ""Strategic Management Control Systems"""
"0","      ""<="", # ""Stratégies digitales"""
"0","      ""<="", # ""Stratégies légales internationales I"""
"0","      ""<="", # ""Stratégies légales internationales II"""
"0","      ""<="", # ""Strategy and Development Modes"""
"0","      ""<="", # ""Strategy in Digital Markets"""
"0","      ""<="", # ""Supply Chain Management and its Latest Trends"""
"0","      ""<="", # ""Text Mining"""
"0","      ""<="", # ""Unethical Decision Making - Advanced"""
"0","      ""<="", # ""Unethical Decision Making - Basics"""
"0","      "
"0","      #### CHUNK OF THE DAY/WEEK"
"0","      ""<="", # Monday Morning"
"0","      ""<="", # Monday Afternoon"
"0","      ""<="", # Tuesday Morning"
"0","      ""<="", # Tuesday Afternoon"
"0","      ""<="", # Wednesday Morning"
"0","      ""<="", # Wednesday Afternoon"
"0","      ""<="", # Thursday Morning"
"0","      ""<="", # Thursday Afternoon"
"0","      ""<="", # Friday Morning"
"0","      ""<="", # Friday Afternoon"
"0","      "
"0","      ### TIME CONSTRAINTS"
"0","      rep.int(""<="", nb_of_timeslot) # Time slot constraint <= 1 (no overlap allowed)"
"0","    )"
"0","    "
"0","    # Set right hand side coefficients"
"0","    f.rhs <- c("
"0","      ### USER CHOICES"
"0","      "
"0","      #### CREDITS -> Should be greater than threshold given by user"
"0","      credits(),     # Credits constraint"
"0","      BA_credits(),  # BA Credits constraint"
"0","      MG_credits(),  # MG Credits constraint"
"0","      "
"0","      #### CLASS"
"0","      rep.int(1, nb_of_class), # Diagonal matrix for each class"
"0","      "
"0","      #### CHUNK OF THE DAY/WEEK -> By default allowed (TRUE), put FALSE if don't want"
"0","      monday_morning(), # Monday Morning class"
"0","      monday_afternoon(), # Monday Afternoon class"
"0","      tuesday_morning(), # Tuesday Morning class"
"0","      tuesday_afternoon(), # Tuesday Afternoon class"
"0","      wednesday_morning(), # Wednesday Morning class"
"0","      wednesday_afternoon(), # Wednesday Afternoon class"
"0","      thursday_morning(), # Thursday Morning class"
"0","      thursday_afternoon(), # Thursday Afternoon class"
"0","      friday_morning(), # Friday Morning class"
"0","      friday_afternoon(), # Friday Afternoon class"
"0","      "
"0","      ### TIME CONSTRAINTS"
"0","      rep.int(1, nb_of_timeslot) # Time slot constraint <= 1 (no overlap allowed)"
"0","    )"
"0","    "
"0","    # Variables choices (1 if class is taken, 0 otherwise)"
"0","    timetable <- lp(""min"", f.obj, f.con, f.dir, f.rhs, all.bin = TRUE)$solution %>%"
"0","      as.data.frame() %>%"
"0","      cbind(HEC_timetables_initial %>%"
"0","              mutate("
"0","                Start = as.character(Start_nice),"
"0","                End = as.character(End_nice), "
"0","                Day = recode_factor(Day, "
"0","                             `1` = ""Monday"", "
"0","                             `2` = ""Tuesday"","
"0","                             `3` = ""Wednesday"","
"0","                             `4` = ""Thursday"","
"0","                             `5` = ""Friday""), "
"0","                Day = as.character(Day), "
"0","                BA = recode(BA, "
"0","                            `1` = ""Yes"", "
"0","                            `0` = ""No"")"
"0","              ) %>%"
"0","              select(Class, -Start_nice, Start, -End_nice, "
"0","                     End, Prof, Day, Credit, BA)) %>%"
"0","     filter(. > 0)  %>%"
"0","     select(Class, Start, End, Prof, Day, Credit, BA)"
"0","      "
"0","  })"
"0","}"
